<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8">
  <style>
    * { margin: 0; padding: 0; box-sizing: border-box; }
    body { font-family: Arial, sans-serif; font-size: 10pt; line-height: 1.4; padding: 40px; }
    .header { margin-bottom: 40px; overflow: hidden; }
    .company-info { float: left; width: 48%; }
    .invoice-info { float: right; width: 48%; text-align: right; }
    .invoice-title { font-size: 32pt; font-weight: bold; margin-bottom: 10px; }
    .customer-section { margin-bottom: 50px; }
    .section-title { font-weight: bold; font-size: 9pt; margin-bottom: 8px; text-transform: uppercase; }
    table { width: 100%; border-collapse: collapse; margin: 50px 0; }
    th { background: #f3f4f6; text-align: left; padding: 10px; font-size: 9pt; text-transform: uppercase; }
    td { padding: 10px; border-bottom: 1px solid #e5e7eb; }
    .totals { float: right; width: 300px; margin-top: 40px; clear: both; }
    .totals-row { padding: 8px 0; overflow: hidden; }
    .totals-row span:first-child { float: left; }
    .totals-row span:last-child { float: right; }
    .grand-total { font-weight: bold; font-size: 14pt; border-top: 2px solid #000; padding-top: 10px; }
    .payment-details { background: #f9fafb; padding: 15px; margin: 50px 0; }
    .status-badge { display: inline-block; padding: 4px 12px; border-radius: 4px; font-size: 9pt; font-weight: bold; }
    .status-sent { background: #dbeafe; color: #1e40af; }
  </style>
</head>
<body>
  <!-- Header -->
  <div class="header">
    <div class="company-info">
      <h2>{{ invoice.company.name }}</h2>
      <p>
        {% if invoice.company.street %}{{ invoice.company.street }}<br>{% endif %}
        {% if invoice.company.city %}{{ invoice.company.city }}{% if invoice.company.state %}, {{ invoice.company.state }}{% endif %} {{ invoice.company.postal_code }}<br>{% endif %}
        {% if invoice.company.country %}{{ invoice.company.country }}<br>{% endif %}
        {% if invoice.company.email %}Email: {{ invoice.company.email }}<br>{% endif %}
        {% if invoice.company.phone %}Phone: {{ invoice.company.phone }}<br>{% endif %}
        {% if invoice.company.vat_number %}VAT: {{ invoice.company.vat_number }}{% endif %}
      </p>
    </div>
    <div class="invoice-info">
      <div class="invoice-title">INVOICE</div>
      <div>
        <strong>Invoice:</strong> {{ invoice.invoice_number }}<br>
        <strong>Date:</strong> {{ invoice.invoice_date }}<br>
        <strong>Due Date:</strong> {{ invoice.due_date }}
      </div>
    </div>
  </div>

  <!-- Customer -->
  <div class="customer-section">
    <div class="section-title">Issued To:</div>
    <div>
      <strong>{{ invoice.customer.name }}</strong><br>
      {% if invoice.customer.street %}{{ invoice.customer.street }}<br>{% endif %}
      {% if invoice.customer.city %}{{ invoice.customer.city }}{% if invoice.customer.state %}, {{ invoice.customer.state }}{% endif %} {{ invoice.customer.postal_code }}<br>{% endif %}
      {% if invoice.customer.country %}{{ invoice.customer.country }}{% endif %}
    </div>
  </div>

  <!-- Line Items -->
  <table>
    <thead>
      <tr>
        <th>Description</th>
        <th style="text-align: right;">Qty</th>
        <th style="text-align: right;">Price</th>
        <th style="text-align: right;">VAT %</th>
        <th style="text-align: right;">Total</th>
      </tr>
    </thead>
    <tbody>
      {% for item in invoice.line_items %}
      <tr>
        <td>{{ item.description }}</td>
        <td style="text-align: right;">{{ item.quantity | format_money }}</td>
        <td style="text-align: right;">{{ item.unit_price | format_money }}</td>
        <td style="text-align: right;">{{ item.vat_rate | format_money }}%</td>
        <td style="text-align: right;">{{ item.total | format_money }}</td>
      </tr>
      {% endfor %}
    </tbody>
  </table>

  <!-- Totals -->
  <div class="totals">
    <div class="totals-row">
      <span>Subtotal:</span>
      <span>{{ invoice.totals.subtotal | format_money }} {{ invoice.currency }}</span>
    </div>
    <div class="totals-row">
      <span>Total VAT:</span>
      <span>{{ invoice.totals.total_vat | format_money }} {{ invoice.currency }}</span>
    </div>
    <div class="totals-row grand-total">
      <span>Grand Total:</span>
      <span>{{ invoice.totals.grand_total | format_money }} {{ invoice.currency }}</span>
    </div>
  </div>

  <!-- Payment Details -->
  {% if invoice.bank_account %}
  <div class="payment-details">
    <div class="section-title">Payment Details</div>
    <div>
      <strong>IBAN:</strong> {{ invoice.bank_account.iban }}<br>
      {% if invoice.bank_account.bank_details %}
      <strong>Bank Details:</strong><br>
      <div style="white-space: pre-line;">{{ invoice.bank_account.bank_details }}</div>
      {% endif %}
    </div>
  </div>
  {% endif %}

  <!-- Payment Terms -->
  <div style="margin-top: 60px; font-size: 9pt;">
    <strong>Payment Terms:</strong><br>
    <div style="white-space: pre-line;">{{ invoice.payment_terms }}</div>
  </div>
</body>
</html>
